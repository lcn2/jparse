.\" section 1 man page for run_bison.sh
.\"
.\" This man page was first written by Cody Boone Ferguson for the IOCCC
.\" in 2022.
.\"
.\" Humour impairment is not virtue nor is it a vice, it's just plain
.\" wrong: almost as wrong as JSON spec mis-features and C++ obfuscation! :-)
.\"
.\" "Share and Enjoy!"
.\"     --  Sirius Cybernetics Corporation Complaints Division, JSON spec department. :-)
.\"
.TH run_bison.sh 8 "08 December 2024" "run_bison.sh" "jparse tools"
.SH NAME
.B run_bison.sh
\- run
.B bison
to generate C code from a
.I *.y
file or use backup files if error
.SH SYNOPSIS
.B run_bison.sh
.RB [\| \-h \|]
.RB [\| \-V \|]
.RB [\| \-v
.IR level \|]
.RB [\| \-o \|]
.RB [\| \-b
.IR bison \|]
.RB [\| \-g
.IR verge \|]
.RB [\| \-p
.IR prefix \|]
.RB [\| \-s
.IR sorry.h \|]
.RB [\| \-S \|]
.RB [\| \-B
.IR dir \|]
.RB [\| \-D
.IR dir \|]
.B \-\-
.RI [\| bison_flags \|]
.SH DESCRIPTION
.B run_bison.sh
attempts to find a recent enough version of
.B bison
(minimum version defined in
.IR run_bison.sh )
and use it to generate code from the
.I prefix.y
file.
The default prefix is
.I jparse
but this script can be used for other parsers as well.
If a recent enough version is not found or
.BR bison (1)
encounters an error (syntax error or anything else) and the
.B \-o
option is not specified, it attempts to use the backup files
.I prefix.tab.ref.c
and
.IR prefix.tab.ref.h .
.SH OPTIONS
.TP
.B \-h
Print help and exit.
.TP
.B \-V
Print version and exit.
.TP
.BI \-v\  level
Set verbosity level to
.IR level
(def: 0).
.TP
.B \-o
Do
.B NOT
use backup files.
If
.BR bison (1)
cannot be used or fails to generate the files the script will fail.
.TP
.BI \-b\  bison
Set
.BR bison (1)
basename to
.IR bison .
.TP
.BI \-g\  verge
Set path to the
.BR verge (1)
tool to
.IR verge .
This is used to determine if the
.BR bison (1)
tool is recent enough.
.TP
.BI \-p\  prefix
Set prefix of files to use to
.IR prefix .
The
.BR bison (1)
input file will be
.IR prefix.y .
If the
.B \-o option was not used and
.BR bison (1)
cannot be used or fails then the backup files
.I prefix.tab.ref.c
and
.I prefix.tab.ref.h
will be used.
.TP
.BI \-s\  sorry.h
Set path of file to prepend to the C output to
.IR sorry.h .
.TP
.B \-S
Suppress prepending apology to generated C output files.
.TP
.BI \-B\  bison_dir
Add directory
.I bison_dir
to list to search for
.BR bison .
.B \-B
can be used more than once.
If not used the script looks at
.BR $PATH .
.TP
.BI \-D\  dir
Set directory to find the flex source file in to
.IR dir .
Default is
.I .
(dot).
.PP
The
.I bison_flags
are any optional flags to give to
.BR bison (1)
before the prefix.
.SH EXIT STATUS
.TP
0
.BR bison (1)
output files formed or backup files used instead
.TQ
1
.BR bison (1)
not found or too old and \-o used
.TQ
2
good
.BR bison (1)
found and ran but failed to form proper output files
.TQ
3
.BR bison (1)
input file missing or not readable: backup files had to be used
.TQ
4
backup files missing or are not readable
.TQ
5
failed to use backup files to form the
.BR bison (1)
C output files
.TQ
6
.I sorry.h
file missing/not readable or
.B verge
missing/not executable
.TQ
7
.B \-h
and help string printed or
.B \-V
and version string printed
.TQ
8
command line usage error
.TQ
>=10
internal error
.SH NOTES
.PP
The
.B \-o
option is mainly for maintainers of the
.B jparse
parser and scanner but it can be used to test if you have a recent enough version of
.BR bison .
The idea behind it is if
.B bison
fails it might indicate a syntax error which the authors of
.B jparse
would need to fix.
.PP
Beware that some
.BR make (1)
implementations have a default rule for
.I *.y
files, so that if one were to do:
.sp
.RS
.ft B
 touch foo.y
 make
.ft R
.RE
.sp
and
.I foo.c
is supposed to exist (and not generated by
.BR bison (1)),
and the Makefile compiles it by default, it will likely cause a compilation error until it is replaced with the original file.
Even worse is that until that file is deleted (assuming
.I foo.y
is in error say because it was created by touch and is empty), make will continue to fail.
.SH BUGS
.PP
If you have any issues with the tool you can open an issue at
.br
.IR \<https://github.com/xexyl/jparse/issues\> .
.SH EXAMPLES
.PP
Run
.B run_bison.sh
with default options, which should attempt to run
.B bison
on the
.I jparse.y
file:
.sp
.RS
.ft B
 ./run_bison.sh
.ft R
.RE
.PP
Run
.B run_bison.sh
but specify that backup files are not to be used in case a recent enough version of
.B bison
cannot be found or fails for some reason (for instance because there is an error in the parser source file):
.sp
.RS
.ft B
 ./run_bison.sh \-o
.ft R
.RE
.PP
Try and run
.B bison
on the file
.I foobar.y
and don't use any backup files:
.sp
.RS
.ft B
 ./run_bison.sh \-o \-p foobar
.ft R
.RE
.PP
Try and run
.B bison
on the file
.I foobar.y
with yacc instead of
.B bison
and don't use any backup files:
.sp
.RS
.ft B
 ./run_bison.sh \-o \-p foobar \-b yacc
.ft R
.RE
.SH SEE ALSO
.BR run_flex (1),
.BR jparse (1)
